---
layout: post
title: "[Bandit] Level 25 → Level 26"
date: 2025-07-12 09:01:00 +0900
categories: [bandit]
tags: [overthewire, bandit, linux, ssh, restricted-shell, vim]
---

## 1. 문제 개요

> **Level Goal**
> 
> Logging in to bandit26 from bandit25 should be fairly easy... The private key for bandit26 is in the home directory of user bandit25.

`bandit26`의 SSH 개인키가 주어져 있으니 로그인만 하면 될 것 같았습니다. 하지만 로그인을 시도하면 "접속되자마자 끊기는" 상황이 발생했습니다. `bandit26` 계정의 쉘(Shell)이 정상적인 Bash가 아니기 때문입니다. 이 제한된 쉘 환경을 **탈출(Break out)** 하는 것이 목표였습니다.

---

## 2. 사용 명령어

| 명령어 | 설명 |
|--------|------|
| `ssh -i [키]` | 개인키로 접속 시도 |
| `more` (또는 `vi`) | 텍스트 뷰어. 이 문제에서는 쉘 탈출의 도구로 사용됨 |

---

## 3. 풀이 과정

`bandit25` 계정으로 로그인합니다.

```bash
ssh bandit25@bandit.labs.overthewire.org -p 2220
```

### 1. 쉘 확인
로그인해보면 `bandit26`의 쉘이 `/usr/bin/showtext`로 설정되어 있습니다.
이 프로그램은 파일 내용을 보여주고 바로 종료되어 버려, 우리가 명령어를 칠 틈을 주지 않습니다.

### 2. Pager 깨트리기 (Interactive Mode 진입)
터미널 창의 크기를 아주 작게 줄입니다. 그러면 긴 텍스트를 한 번에 다 보여줄 수 없어서 `more` (또는 `less`) 상태에서 "더 보려면 스페이스바를 누르세요" 하고 멈추게 됩니다.
이 상태가 바로 **상호작용 가능한 상태**입니다.

다시 SSH 접속 명령을 입력합니다.

```bash
bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost -p 2220
```

이제 로고가 짤려서 나오고, 아래에 `--More--` 같은 표시가 뜨면서 멈춰 있을 것입니다.

### 3. Vim 실행
Pager(`more`) 상태에서 `v` 키를 누르면 `vim` 에디터가 실행됩니다.
(이 서버의 `more`는 사실 `vi` 기능을 내장하고 있거나, 에디터 호출 기능이 열려있습니다.)

### 4. 쉘 실행 (Shell Spawning)
`vim` 안에서는 외부 명령어를 실행할 수 있는 기능이 있습니다.
1. `:set shell=/bin/bash` 입력 후 엔터 (vim이 사용할 쉘을 bash로 변경)
2. `:shell` 입력 후 엔터 (쉘 실행)

```bash
bandit26@bandit:~$
```
드디어 `bandit26` 프롬프트를 얻었습니다!

### 5. 비밀번호 확인

```bash
bandit26@bandit:~$ cat /etc/bandit_pass/bandit26
5czgV9LnmM1B67sxKoVJePPQN1Y5wluG
```
(이 쉘에서 `bandit26-do` 같은 다음 단계 도구를 바로 실행할 수도 있습니다.)

---

## 4. 결과

<details markdown="1">
<summary>비밀번호 확인</summary>

```
5czgV9LnmM1B67sxKoVJePPQN1Y5wluG
```

</details>

---

## 5. 배운 점

1. **Restricted Shell 탈출**: 시스템 관리자가 의도적으로 사용자의 행동을 제약하더라도, `vim`, `more`, `less` 등 상호작용이 가능한 프로그램이 실행된다면 이를 통해 쉘 스포닝(Shell Spawning)이 가능할 수 있습니다.
2. **Pager의 특성**: 터미널 크기에 따라 동작이 달라지는 점을 이용한 창의적인 해킹 기법입니다.

---

## 6. 보안 관점

- **환경 분리 실패**: 제한된 사용자를 만들 때는 단순히 로그인 쉘만 바꾸는 것으로는 부족합니다. 사용자가 실행 가능한 모든 명령어(`vim`, `more` 등)에서 또 다른 명령어를 실행할 수 있는 기능(Shell Escape)이 있는지 꼼꼼히 검토해야 합니다.
- **Vim의 강력함**: Vim은 단순한 에디터가 아니라 파일 탐색, 명령어 실행, 네트워크 연결까지 가능한 강력한 도구이므로, 보안이 중요한 환경에서는 주의해서 권한을 부여해야 합니다.

<hr class="short-rule">