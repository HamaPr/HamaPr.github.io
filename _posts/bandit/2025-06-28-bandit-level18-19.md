---
layout: post
title: "[Bandit] Level 18 → Level 19"
date: 2025-06-28 09:04:00 +0900
categories: [bandit]
tags: [overthewire, bandit, linux, ssh, .bashrc]
---

## 1. 문제 개요

> **Level Goal**
> 
> The password for the next level is stored in a file `readme` in the home directory. Unfortunately, someone has modified **`.bashrc`** to log you out when you log in with SSH.

비밀번호를 알고 있어서### 1. 접속 시도 (실패)
평소처럼 SSH 접속을 하면, 배너 메시지까지는 나오는데 바로 `Bye Bye` 하고 접속이 끊깁니다.
`v`옵션 등으로 확인해보면 `.bashrc` 같은 설정 파일에서 강제로 로그아웃(`exit`) 시키는 코드가 들어있는 것 같습니다. 쉘(Shell)을 얻지 못하는 상황에서 명령어를 실행해야 했습니다.

---

## 2. 사용 명령어

| 명령어 | 설명 |
|--------|------|
| `ssh [옵션] [호스트] "[명령어]"` | 원격 접속 후 쉘을 띄우지 않고, **지정한 명령어만 실행**하고 결과를 받아옵니다. |

---

## 3. 풀이 과정

`bandit18` 계정으로 로그인합니다.

```bash
ssh bandit18@bandit.labs.overthewire.org -p 2220
```

### 1. 접속 시도 (실패)
평소처럼 SSH 접속을 하면, 배너 메시지까지는 나오는데 바로 `Bye Bye` 하고 접속이 끊깁니다.
`v`옵션 등으로 확인해보면 `.bashrc` 같은 설정 파일에서 강제로 로그아웃(`exit`) 시키는 코드가 들어있는 것 같습니다. 쉘(Shell)을 얻지 못하는 상황에서 명령어를 실행해야 했습니다.

```
bandit18@bandit.labs.overthewire.org's password:
Linux bandit ...
Byebye !
Connection to bandit.labs.overthewire.org closed.
```

### 2. 원격 명령 실행 (해결책)
SSH는 접속해서 쉘을 띄우는 것뿐만 아니라, **접속하자마자 특정 명령을 실행하고 결과만 받아오는 기능**이 있습니다.
이 기능을 쓰면 로그인 쉘(bash)이 뜨면서 `.bashrc`가 실행되기 전에, 우리가 원하는 명령(`cat ...`)만 쏙 실행하고 나올 수 있습니다.

### 3. 실행 결과
`cat readme`를 인자로 넘겨줍니다.

```bash
ssh bandit18@bandit.labs.overthewire.org -p 2220 "cat readme"
```

(비밀번호 입력)

접속에 성공하면서 `readme` 파일의 내용만 출력되고 연결이 종료됩니다.

```
IueksS7UslEw8T7j3o1C5oE1eYy5IBDd
```

### 추가 팁: 강제로 쉘 얻기
만약 명령어 하나만 실행하는 게 아니라 계속 작업을 하고 싶다면? SSH의 `-t` 또는 `-T` 옵션을 사용해 볼 수 있습니다. `bash --noprofile`을 실행하면 설정 파일을 로드하지 않고 쉘을 띄울 수도 있습니다.

```bash
ssh bandit18@... -p 2220 -t "bash --noprofile"
```

---

## 4. 결과

<details markdown="1">
<summary>비밀번호 확인</summary>

```
IueksS7UslEw8T7j3o1C5oE1eYy5IBDd
```

</details>

---

## 5. 배운 점

1. **SSH 원격 명령 실행**: SSH는 단순히 원격 접속뿐만 아니라, 원격지에서 명령어를 실행하고 결과만 가져오는 자동화 작업에도 많이 쓰입니다. (예: 젠킨스 배포 스크립트)
2. **로그인 스크립트**: `.bashrc`, `.bash_profile` 등은 사용자가 로그인할 때마다 실행되므로, 여기에 악성 코드가 심어지면 로그인할 때마다 피해를 입을 수 있습니다.

---

## 6. 보안 관점

- **Restricted Shell (제한된 쉘)**: 시스템 관리자는 특정 사용자가 서버에 접속은 하되 아무것도 못하게 막고 싶을 때, 로그인 쉘을 `/bin/false`나 `/sbin/nologin`으로 설정합니다. 하지만 이 문제처럼 SSH 명령 실행 기능을 막지 않으면 보안 구멍이 뚫릴 수 있습니다.

<hr class="short-rule">