---
layout: post
title: "[Bandit] Level 12 → Level 13"
date: 2025-06-15 09:03:00 +0900
categories: [bandit]
tags: [overthewire, bandit, linux, xxd, gzip, tar, bzip2]
---

## 1. 문제 개요

> **Level Goal**
> 
> The password for the next level is stored in the file `data.txt`, which is a **hexdump** of a file that has been **repeatedly compressed** (반복적으로 압축됨).

이번 레벨은 Hexdump를 바이너리로 복원한 뒤, 여러 번 겹겹이 쌓인 압축(`gzip`, `bzip2`, `tar`)을 하나씩 풀어내야 비밀번호를 얻을 수 있었습니다. 인내심과 `file` 명령어 활용 능력이 필요했습니다.

---

## 2. 사용 명령어

| 명령어 | 설명 |
|--------|------|
| `xxd -r` | Hexdump(16진수) 데이터를 원래의 바이너리 파일로 복원 (Reverse) |
| `file` | 파일의 종류(압축 포맷) 확인 |
| `gzip -d` | `.gz` 압축 해제 |
| `bzip2 -d` | `.bz2` 압축 해제 |
| `tar -xf` | `.tar` 아카이브 풀기 (Extract File) |
| `mv` | 파일 이름 변경 (확장자를 맞춰주기 위해 사용) |

---

## 3. 풀이 과정

`bandit12` 계정으로 로그인합니다.

```bash
ssh bandit12@bandit.labs.overthewire.org -p 2220
```

### 1. 작업 공간 생성
파일을 계속 압축 해제하며 이름도 바꿔야 하므로, `/tmp` 디렉토리에 나만의 공간을 만듭니다.

```bash
mkdir /tmp/mywork123
cp data.txt /tmp/mywork123/
cd /tmp/mywork123
```

### 2. Hexdump 복원 (`xxd`)
`data.txt`는 Hexdump 텍스트 파일입니다. 이를 다시 바이너리 파일로 되돌려야 합니다.
`xxd -r` (revert) 명령어를 사용합니다.

```bash
xxd -r data.txt > data.bin
```
이제 `data.bin`이라는 바이너리 파일이 생겼습니다.

### 3. 반복적인 압축 해제
이제부터 `file` 명령어로 종류를 확인하고, 그에 맞는 도구로 압축을 푸는 과정을 반복합니다.

**단계 1: gzip 압축 해제**
```bash
file data.bin
# 결과: gzip compressed data...
mv data.bin data.gz
gzip -d data.gz
```

**단계 2: bzip2 압축 해제**
```bash
file data
# 결과: bzip2 compressed data...
mv data data.bz2
bzip2 -d data.bz2
```

**단계 3: tar 압축 해제**
```bash
file data
# 결과: POSIX tar archive...
mv data data.tar
tar -xf data.tar
```

이 과정을 5~6번 정도 반복하면 마지막에 `ASCII text` 파일이 나옵니다.

```bash
bandit12@bandit:/tmp/mywork123$ cat data8.bin
The password is QfSndnhTjJ2w4Tamp2Z22YfA4r233FkI
```

---

## 4. 결과

<details markdown="1">
<summary>비밀번호 확인</summary>

```
QfSndnhTjJ2w4Tamp2Z22YfA4r233FkI
```

</details>

---

## 5. 배운 점

1. **파일 확장자의 의미**: 리눅스에서는 확장자가 파일의 동작을 결정하지 않지만(`file` 명령어로 확인), 압축 해제 도구들(`gzip`, `bzip2`)은 올바른 확장자를 요구하는 경우가 많습니다.
2. **Hexdump**: 바이너리 파일을 전송하거나 분석하기 위해 16진수 텍스트로 변환한 형태입니다. 이를 다시 실행 가능한 파일로 만들려면 `xxd -r`가 필요합니다.

---

## 6. 보안 관점

- **다중 압축을 통한 탐지 우회**: 악성코드는 백신(Anti-virus)이나 보안 장비의 탐지를 피하기 위해 여러 번 압축하거나 난독화(Packing)하여 배포되기도 합니다. 보안 장비가 압축을 3~4번까지는 풀어보지만, 10번 이상 되어있으면 성능 문제로 포기하고 통과시킬 수도 있기 때문입니다. ("Archive Bomb" 또는 "Zip Bomb" 공격과는 약간 다른 개념이지만 유사한 맥락)

<hr class="short-rule">