---
layout: post
title: "Firewall & WAF"
date: 2025-08-18 17:00:00 +0900
categories: [web-technology]
---

## 1. 개요

방화벽은 IP와 포트 기반으로 네트워크 접근을 제어하고 웹 방화벽(WAF)은 HTTP 트래픽의 내용을 분석하여 웹 공격을 차단하는 보안 솔루션이다.

방화벽과 WAF는 모두 네트워크 트래픽을 필터링하여 시스템을 보호하지만 동작하는 **계층(Layer)**과 **보호 대상**이 다르다. 이 차이점을 이해하는 것은 계층적 방어(Defense in Depth) 전략을 이해하는 데 중요하다.

*   ***방화벽 (Firewall):*** 주로 **네트워크 계층(L3) / 전송 계층(L4)**에서 동작하며 IP 주소와 포트 번호를 기반으로 접근을 제어한다.
*   ***웹 방화벽 (WAF, Web Application Firewall):*** **애플리케이션 계층(L7)**에서 동작하며 HTTP 트래픽의 내용(Payload)을 분석하여 웹 공격을 탐지하고 차단한다.

---

## 2. 방화벽 (Firewall)

*   ***비유:*** 건물의 출입문을 지키는 '경비원'과 같다.
*   ***검사 기준:***
    *   출발지/목적지 IP 주소
    *   출발지/목적지 포트 번호
    *   프로토콜 (TCP · UDP · ICMP)
*   ***역할:*** "허용된 IP와 포트로만 들어오고 나갈 수 있다"는 규칙을 적용한다. 예를 들어, 80번(HTTP), 443번(HTTPS) 포트를 제외한 모든 포트로의 접근을 차단하여 불필요한 서비스가 외부에 노출되는 것을 막는다.
*   ***한계:***
    방화벽은 트래픽의 '겉모습'(IP, 포트)만 볼 뿐, 그 안에 담긴 '내용'은 검사하지 않는다. 따라서 허용된 80번 포트를 통해 들어오는 **SQL Injection**이나 **XSS** 공격 페이로드는 정상적인 HTTP 트래픽으로 간주하고 그대로 통과시킨다.

---

## 3. 웹 방화벽 (WAF)

*   ***비유:*** 건물 안의 특정 사무실(웹 서버) 입구에서 방문객의 '소지품'(HTTP 요청 내용)을 검사하는 '보안 요원'과 같다.
*   ***검사 기준:***
    *   HTTP 요청/응답 헤더
    *   HTTP 요청/응답 본문 (Body)
    *   쿠키, URL 파라미터
*   ***역할:*** HTTP 트래픽의 내용을 심층적으로 분석하여 알려진 공격 패턴(Signature)과 일치하는지 확인한다. 예를 들어, URL 파라미터에 `' OR '1'='1` 과 같은 SQL Injection 공격 패턴이 포함되어 있으면 해당 요청을 악의적인 것으로 판단하고 차단한다.
*   ***주요 방어 공격:***
    *   SQL Injection
    *   Cross-Site Scripting (XSS)
    *   경로 조작 (Path Traversal)
    *   명령어 인젝션 (Command Injection)

---

## 4. 보안 관점에서의 의미

방화벽과 WAF는 서로를 대체하는 관계가 아니라 각기 다른 계층에서 서로를 보완하는 **상호 보완적인 관계**이다.

1.  ***1차 방어선 (방화벽):*** 먼저 방화벽이 IP와 포트 기반으로 비정상적인 접근을 차단하여 웹 서버가 불필요한 위협에 노출되는 것을 막는다.
2.  ***2차 방어선 (WAF):*** 방화벽을 통과한 HTTP 트래픽에 한해서 WAF가 내용 검사를 통해 SQL Injection과 같은 애플리케이션 레벨의 공격을 정교하게 막아낸다.

이처럼 다층적인 방어 체계를 구축함으로써 하나의 방어선이 뚫리더라도 다음 방어선이 위협을 막아내어 시스템의 전체적인 보안 수준을 높일 수 있다.

<hr class="short-rule">
