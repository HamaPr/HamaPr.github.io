---
layout: post
title: "SSH 개념과 포트포워딩"
date: 2025-10-16 17:00:00 +0900
categories: [linux]
---

## 1. 개념

**SSH (Secure Shell)**는 네트워크를 통해 다른 컴퓨터에 안전하게 접속하기 위한 프로토콜.

### 기본 정보

| 항목 | 내용 |
|------|------|
| 포트 | 22 (TCP) |
| 암호화 | 공개키 기반 암호화 |
| 대체 대상 | Telnet (23, 평문 전송) |

### SSH로 할 수 있는 것
- **원격 접속**: 서버 터미널 제어
- **파일 전송**: SCP, SFTP
- **포트포워딩**: 터널링으로 방화벽 우회
- **키 인증**: 비밀번호 없이 로그인

### 왜 SSH를 사용하는가?

| 구분 | Telnet | SSH |
|------|--------|-----|
| 암호화 | ❌ 평문 | ✅ 암호화 |
| 패킷 스니핑 | 취약 | 안전 |
| 포트 | 23 | 22 |

### 인증 방식
1. **비밀번호 인증**: 매번 입력
2. **키 인증**: 공개키를 서버에 등록 후 비밀번호 없이 로그인

---

## 2. 설치 방법

### Rocky Linux / CentOS
```bash
# SSH 서버 설치
dnf install -y openssh-server

# 서비스 활성화 및 시작
systemctl enable --now sshd

# 방화벽 허용
firewall-cmd --permanent --add-service=ssh
firewall-cmd --reload
```

### 설치 확인
```bash
# SSH 서비스 상태 확인
systemctl status sshd

# 포트 리스닝 확인
ss -nat | grep :22
```

---

## 3. 사용법

### 기본 접속
```bash
ssh [사용자]@[서버IP]
# 예시
ssh root@10.0.0.11
```

### SSH 키 생성 및 등록
```bash
# 클라이언트에서 키 생성
ssh-keygen -t rsa -b 4096

# 서버에 공개키 등록
ssh-copy-id [사용자]@[서버IP]
```

### 주요 설정 파일
- `/etc/ssh/sshd_config` - 서버 설정
- `~/.ssh/authorized_keys` - 허용된 공개키 목록
- `~/.ssh/known_hosts` - 접속했던 서버 목록

---

## 4. 실습

### 랩 환경 구성

| 호스트 | IP | 서브넷 | 게이트웨이 | DNS | 역할 |
|--------|------|--------|------------|-----|------|
| rocky9-1 | 10.0.0.11 | 255.255.255.0 | 10.0.0.254 | 168.126.63.1 | 주 DNS, DHCP, WEB, NFS-SERVER |
| rocky9-2 | 10.0.0.12 | 255.255.255.0 | 10.0.0.254 | 168.126.63.1 | 보조 DNS, DHCP, WEB, NFS-CLIENT |
| rocky9-3 | 10.0.0.13 | 255.255.255.0 | 10.0.0.254 | 168.126.63.1 | 보조 DNS, FTP, WEB, MAIL |
| w10-1 | 10.0.0.101 | 255.255.255.0 | 10.0.0.254 | 10.0.0.11 | Windows 10 클라이언트 |
| w11-1 | 10.0.0.201 | 255.255.255.0 | 10.0.0.254 | 10.0.0.11 | Windows 11 클라이언트 |

### 포트포워딩을 통한 SSH 접속

Xshell을 이용해 각 서버에 SSH 접속을 테스트했습니다. `who` 명령으로 여러 클라이언트 IP에서 동시 접속되어 있음을 확인할 수 있습니다.

**rocky9-1** (10.0.0.11) - 포트포워딩으로 다중 클라이언트 접속 확인

![SSH 포트포워딩 - rocky9-1](/assets/images/linux/ssh-session-server1.png)

`who` 명령 결과 여러 소스 IP(10.10.36.x 등)에서 동시 접속 중임을 확인:
- `pts/0`: 10.10.36.2
- `pts/1`: 10.10.36.3
- `pts/3`: 10.10.36.12

**rocky9-2** (10.0.0.12)

![SSH 포트포워딩 - rocky9-2](/assets/images/linux/ssh-session-server2.png)

**rocky9-3** (10.0.0.13)

![SSH 포트포워딩 - rocky9-3](/assets/images/linux/ssh-session-server3.png)

<hr class="short-rule">
