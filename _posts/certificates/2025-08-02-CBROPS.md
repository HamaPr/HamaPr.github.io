---
layout: post
title: CyberOps Associate (200-201 CBROPS) 수료
date: 2025-08-02 15:00:00 +0900
categories: [certificates]
tags: [Cisco, CyberOps]
---

Cisco CyberOps Associate (200-201 CBROPS) 과정을 통해 위협 탐지, 로그 분석, 네트워크 트래픽 해석, 공격 흐름 추적 능력을 학습했습니다.

---

### Wireshark로 HTTP 트래픽 분석: 악성 스크립트 탐지 절차

#### ***필터 적용 및 대상 좁히기***
```bash
http                     # HTTP 트래픽만 필터
http.request.method == "GET"  # GET 요청만 추출
```

#### ***의심스러운 요청 식별 기준***
- URL에 `.js`, `.php`, `.exe` 확장자 포함
- 파라미터에 `eval=`, `cmd=`, `exec=` 등 명령 실행 키워드
- 비정상적으로 긴 URI (예: base64 인코딩된 문자열)

#### ***TCP Stream 추적***
- 의심 패킷 우클릭 → **Follow → TCP Stream**
- 서버 응답 페이로드에서 다음 패턴 탐색:
  - `eval(`, `unescape(`, `String.fromCharCode(`
  - `<iframe src="http://malicious.site">`
  - `document.write(unescape("%u..."))`

#### ***악성 징후 확인 명령어 (Linux 기반 분석 시)***
```bash
strings capture.pcap | grep -i "eval\|iframe\|unescape"  # PCAP 내 문자열 스캔
```

> **주의**: `Follow TCP Stream`에서 인코딩이 `UTF-8`이 아닌 경우 `Raw`로 전환 후 분석

---

### SIEM ‘Multiple Login Failures’ 얼럿 분석 절차

#### ***1단계: 얼럿 메타데이터 확인***
- 발생 시간 (Timestamp)
- 출발지 IP (Source IP)
- 대상 계정 (Target Username)
- 대상 호스트 (Destination Host)

#### ***2단계: 타임라인 연계 분석***
```bash
# 동일 IP에서 발생한 직전/직후 이벤트 조회
EventID 4625 (로그인 실패) → EventID 4624 (로그인 성공) → EventID 4688 (프로세스 생성)
```

#### ***3단계: IP 평판 확인 (명령어 기반)***
```bash
curl -s "https://www.virustotal.com/api/v3/ip_addresses/1.2.3.4" \
-H "x-apikey: YOUR_API_KEY" | jq '.data.attributes.last_analysis_stats'
```
→ `malicious > 0` 또는 `suspicious > 5` → 악성 IP 확률 높음

#### 4단계: 계정 탈취 여부 확인
- 동일 계정으로 다른 IP에서 로그인 성공 기록 존재 여부
- 로그인 성공 후 비정상 프로세스 실행 기록 (예: `powershell.exe -enc ...`)

> **핵심**: 실패 → 성공 → 비정상 활동 순서 = 계정 탈취 가능성 높음

---

### 실습을 통해 얻은 기술적 성과

#### ***TCP 3-Way Handshake 이상 탐지***
- 정상: `SYN` → `SYN-ACK` → `ACK`
- 이상 패턴:
  - `SYN` 폭주 → 포트 스캔 (nmap -sS)
  - `FIN` 단독 전송 → 스캔 공격 (nmap -sF)
  - `RST` 응답 없이 연결 유지 → TCP 세션 하이재킹 시도

#### ***NetFlow 기반 통신 패턴 분석***
- 명령어: `nfdump -r netflow.pcap 'host 192.168.1.100'`
- 이상 징후:
  - 동일 IP에서 다수 포트로 연결 시도 → 수평 이동 탐지
  - 외부 IP로 고정 포트(4444, 5555) 연결 → C2 통신 의심

#### ***ATT&CK TTPs 매핑 실습***
- 탐지된 이벤트 → MITRE ATT&CK 매핑 예시:
  - `T1078 - Valid Accounts` → 로그인 실패 후 성공
  - `T1059 - Command and Scripting Interpreter` → PowerShell 실행
  - `T1043 - Commonly Used Port` → HTTP/HTTPS 포트로 C2 통신

#### ***로그 연계 분석 오류 해결***
- 증상: SIEM에서 계정 탈취 의심 → 근거 부족
- 진단: 호스트 로그(EventID 4624)와 네트워크 로그(NetFlow) 시간대 불일치
- 해결: 모든 장비 NTP 동기화 확인 → 타임라인 재구성 → 공격 흐름 명확화

---

### CyberOps 핵심

#### ***주요 데이터 소스 및 분석 도구***
```bash
tcpdump -i eth0 -w capture.pcap          # 실시간 패킷 캡처
tshark -r capture.pcap -Y "http"         # CLI 기반 Wireshark 필터
grep "Failed password" /var/log/auth.log # SSH 로그인 실패 추출
journalctl -u sshd --since "1 hour ago"  # systemd 기반 로그 조회
```

#### ***Cyber Kill Chain 단계별 탐지 포인트***
1. **정찰 (Reconnaissance)**: 포트 스캔, DNS 질의 증가
2. **무기화 (Weaponization)**: 피싱 메일 첨부파일 다운로드
3. **전달 (Delivery)**: 악성 URL 클릭, 이메일 열람
4. **공격 (Exploitation)**: 취약점 이용 코드 실행
5. **설치 (Installation)**: 백도어, RAT 설치
6. **C2 (Command & Control)**: 외부 IP와 고정 포트 통신
7. **목표 달성 (Actions)**: 데이터 유출, 암호화, 삭제

#### ***SOC 분석가 필수 개념***
- **False Positive**: 정상 활동이 위협으로 오인 → 규칙 조정 필요
- **False Negative**: 실제 공격이 탐지되지 않음 → 탐지 로직 개선 필요
- **Triage**: 다수 얼럿 중 우선순위 결정 → 영향도/신뢰도 기반
- **Containment**: 공격 확산 차단 → 네트워크 격리, 계정 잠금

#### ***기본 명령어 및 검증***
```bash
whois 1.2.3.4                  # IP 소유자 및 국가 확인
nslookup malicious.site        # 도메인 → IP 확인
ss -tuln | grep :4444          # 리스닝 포트 확인 (C2 의심)
cat /proc/net/tcp              # 커널 레벨 연결 상태 확인
```

<hr class="short-rule">